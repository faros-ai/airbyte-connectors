# Office 365 Calendar Integration Test Environment Configuration
# 
# Copy this file to test/integration/.env and fill in your actual values
# DO NOT commit the .env file - it contains sensitive credentials!

# =====================================================================
# REQUIRED: Azure AD Application Credentials
# =====================================================================
# Get these from Azure Portal > App registrations > Your app

# Your Azure AD tenant ID (GUID format or domain format)
# Example: 12345678-1234-1234-1234-123456789012
# Example: contoso.onmicrosoft.com
INTEGRATION_TENANT_ID=your-tenant-id-here

# Your application (client) ID from Azure App Registration
# Example: 87654321-4321-4321-4321-210987654321
INTEGRATION_CLIENT_ID=your-client-id-here

# Your application client secret value (not the secret ID)
# Example: abc123~def456.ghi789_jkl012
INTEGRATION_CLIENT_SECRET=your-client-secret-here

# =====================================================================
# OPTIONAL: Connector Configuration
# =====================================================================

# Enable organization-wide calendar access (requires admin consent)
# Default: false
INTEGRATION_DOMAIN_WIDE=false

# Maximum events to fetch per API request (1-10000)
# Default: 100 (small batches for testing)
INTEGRATION_EVENTS_MAX_RESULTS=100

# Number of days to look back for events (1-3650)
# Default: 30 (recent events only for testing)
INTEGRATION_CUTOFF_DAYS=30

# =====================================================================
# TEST DATA CONFIGURATION
# =====================================================================

# Email address of test user for validation
# Should be a user in your test tenant
INTEGRATION_TEST_USER_EMAIL=testuser@yourcompany.com

# Comma-separated list of known calendar IDs for testing
# Use actual calendar IDs from your test environment
# You can find these by running the connector discovery first
INTEGRATION_KNOWN_CALENDAR_IDS=calendar-id-1,calendar-id-2,calendar-id-3

# JSON object mapping calendar IDs to expected event counts
# Used for validation - update based on your test data
INTEGRATION_EXPECTED_EVENT_COUNTS={"calendar-id-1":5,"calendar-id-2":10,"calendar-id-3":15}

# Calendar ID with large dataset for performance testing
# Should have 100+ events for meaningful performance tests
INTEGRATION_LARGE_DATASET_CALENDAR_ID=large-calendar-id

# =====================================================================
# TEST EXECUTION CONFIGURATION
# =====================================================================

# Maximum time to wait for operations (milliseconds)
# Default: 30000 (30 seconds)
INTEGRATION_TIMEOUT_MS=30000

# Enable tests that create/modify/delete data
# WARNING: Only enable in dedicated test environments!
# Default: false (safe mode)
INTEGRATION_ENABLE_DESTRUCTIVE_TESTS=false

# =====================================================================
# SETUP INSTRUCTIONS
# =====================================================================
#
# 1. CREATE AZURE AD APP REGISTRATION:
#    - Go to https://portal.azure.com
#    - Navigate to Azure Active Directory > App registrations
#    - Click "New registration"
#    - Choose account types and create app
#    - Note the Application (client) ID and Directory (tenant) ID
#
# 2. GENERATE CLIENT SECRET:
#    - In your app registration, go to "Certificates & secrets"
#    - Click "New client secret"
#    - Copy the secret VALUE (not the ID)
#
# 3. CONFIGURE API PERMISSIONS:
#    - Go to "API permissions" in your app registration
#    - Add Microsoft Graph > Application permissions:
#      * Calendars.Read (or Calendars.Read.All for org-wide)
#      * User.Read (or User.Read.All for org-wide)
#    - Click "Grant admin consent" 
#
# 4. SET UP TEST DATA:
#    - Create test calendars in your tenant
#    - Add some test events to those calendars
#    - Update the calendar IDs and event counts above
#
# 5. RUN INTEGRATION TESTS:
#    npm test -- --testNamePattern="Integration"
#
# =====================================================================
# SECURITY NOTES
# =====================================================================
#
# - Never commit this file with real credentials to version control
# - Use a dedicated test tenant, not production
# - Rotate secrets regularly
# - Use least-privilege permissions
# - Monitor test app usage in Azure AD logs
# - Consider using certificate-based auth for production testing
#
# =====================================================================